{
    "contents" : "library(igraph)\n\n#The number of prey species\nN <- 100\n\nnv <- runif(N)\nC = 0.02\nadj_m <- matrix(0,N,N)\n\ndisconnected <- TRUE\n\nnum_prey <- numeric(N)\n\nbasal <- min(nv)\nbasal_pos <- which(nv == basal)\nnum_prey[basal_pos] <- NA\n\nwhile (disconnected == TRUE) {\n  \n  #which species have no interactions?\n  empty <- which(num_prey==0)\n  \n  \n  #Loop over each species to determine range of prey\n  for (i in empty) {\n    #The niche value of species i\n    n <- nv[i]\n    \n    \n    #Define the range\n    alpha <- 1\n    beta <- (alpha/(2*C)) - alpha\n    r <- rbeta(1,alpha,beta)*n\n    \n    #Define the center of the range\n    r1 <- min(r/2,n)\n    r2 <- max(r/2,n)\n    c <- runif(1,r1,r2)\n    \n    max_width <- c+(r/2)\n    min_width <- c-(r/2)\n    \n    \n    #Which species fall within this range\n    num_prey[i] <- 0\n    for (j in 1:N) {\n      if ((nv[j] < max_width) && (nv[j] > min_width)) {\n        #adj_m[i,j] <- 1\n        adj_m[j,i] <- 1 #arrow points along trophic flow\n        num_prey[i] <- num_prey[i] + 1\n      }\n    }\n    \n    \n  }\n  \n  #Is the food web disconnected?\n  #rsums <- apply(adj_m,1,sum)\n  if (length(which(num_prey == 0)) > 0) {\n    disconnected <- TRUE\n    \n    #remove disconnected species\n    rm_sp <- which(num_prey == 0)\n    num_rm <- length(rm_sp)\n    \n    #update niche axis with new values\n    new_nv <- runif(N)\n    for (j in rm_sp) {\n      nv[j] <- new_nv[j]\n    }\n    \n  } else {\n    disconnected <- FALSE\n  }\n  \n  \n}\n\n\ng <- graph.adjacency(adj_m, mode = \"directed\")\n#plot(g,layout=layout.reingold.tilford(g,root=basal_pos,flip.y=FALSE),vertex.size=5)\n\n\ncoords <- cbind(runif(N),nv)\nplot(g,layout=coords,vertex.size=5,edge.arrow.size=0.4,main=ecount(g)/N^2)\n\n\n",
    "created" : 1423604192522.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2473453152",
    "id" : "873DB283",
    "lastKnownWriteTime" : 1423691464,
    "path" : "~/Dropbox/PostDoc/2015_LifeCycle/NicheModel/NicheModel.R",
    "project_path" : "NicheModel.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}